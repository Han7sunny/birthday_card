<!-- card/templates/card/post_list.html -->
{% extends "layout.html" %}
{%load split from card_split%}
{% block title %}ê¸€ëª©ë¡{% endblock title%}
{%block head%}
<style>
a{color:black;}
#empty_button{margin: 3%;}
#message{color:lightcoral;}
table{border-color: #dee2e6;}
</style>
<script>
    var today = new Date(); 
    var month = today.getMonth() + 1;
    var day = today.getDate();

    var birthday = "{{user.birthday}}".split("/");
    var birthday_month = Number(birthday[0])
    var birthday_day = Number(birthday[1])
    var birthday_check = "{{birthday}}"

    $(document).ready(function(){
        if (birthday_month === month && birthday_day + 9 === day) { // ìƒì¼ë‚ ì´ë©´ ë¦¬ìŠ¤íŠ¸ ì•ˆ ë³´ì´ê³  ìš°í¸í•¨ ê°ˆë˜ìš©?
            if(!birthday_check){
                $('#card_list').hide();
            }
            else{
                $('#HBD').hide();
                $('#card_list').show();
            }
        }else{            
            $('#HBD').hide();
        }
    })
</script>
{%endblock head%}

{% block contents%}

{%if messages%} {#ê³„ì† ë‚¨ëŠ” ê°’ì´ ì•„ë‹ˆì•¼;;;#}
    {%for message in messages%}
    {%if message.message != 'relogin'%}
        <div class = "alert notification-container" role="alert" id="message">
            {{message.message}} 
        </div>
    {%endif%}
    {%endfor%}
{%endif%}

<div id = 'HBD' style="padding: 3%;">
<!--ìƒì¼ì¶•í•˜-->
<h2>{{user.username}}ë‹˜ì˜ ìƒì¼ì„ ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
<h5> ìš°í¸í•¨ì„ í™•ì¸í•˜ì‹œê² ì–´ìš”?</h5>
<a class = "btn" href = "{%url 'relogin' user.username%}" style="background-color:aliceblue; color: plum;">í™•ì¸í•˜ê¸°</a>
</div>
<div id = 'card_list'>
{% if total == 0 %}
ğŸ“­ <br>
ì•„ì§ ë„ì°©í•œ í¸ì§€ê°€ ì—†ì–´ìš”! <br>
{{user.username}}ë‹˜ì—ê²Œ ì²«ë²ˆì§¸ í¸ì§€ë¥¼ ë³´ë‚´ì£¼ì„¸ìš”! <br>
<button type = 'button' id='empty_button' class = 'btn' onclick='location.href = "/{{user.username}}/card/create"' style="background-color:aliceblue; color: plum;" >í¸ì§€ ì‘ì„±</button> <br>

{%else%}
<h3 style="padding: 3%;">ğŸ“© {{user.username}}ë‹˜ ì•ìœ¼ë¡œ {{total}}í†µì˜ í¸ì§€ê°€ ë„ì°©í–ˆì–´ìš”! ğŸ“©</h3>
{%if not birthday%}
<button type = 'button' id = 'create_button' class = 'btn' onclick='location.href = "/{{user.username}}/card/create"' style="background-color:aliceblue; color: plum; float: right;" >í¸ì§€ ì‘ì„±</button> <br><br>
{%endif%}
<table class='table'>
    <thead class="thead-light">
        <tr>
            <th>ë³´ë‚´ëŠ” ì´</th>
        </tr>
    </thead>
    <tbody>
        {% for card in object_list %}
            <tr>
                <td>
                    {%if birthday%}
                        <a href="{% url 'card:detail' user.username post.pk %}" style="text-decoration:none">
                            {{card.card_from|split}}
                        </a>
                    {%else%}
                        <a href="{% url 'card:auth' user.username post.pk %}" style="text-decoration:none">
                            {{card.card_from|split}}
                        </a>
                    {%endif%}
                </td>
            </tr>
        {% endfor %}

    </tbody>
</table>

{% if is_paginated %}
<ul class='pagination justify-content-center'> 
<!-- ############################################################
    ì´ì „ í˜ì´ì§€ ê·¸ë£¹ ì´ë™ ë§í¬
############################################################ -->
{% if has_previous %}
    <li class='page-item'>
        <a href="{%url 'login_user' user.username %}?page={{previous_page_no}}" class='page-link'>ì´ì „</a>
    </li>       
{% else%}
    <li class='page-item'>
        <span class='page-link'>&laquo;</span>
    </li>
{% endif %}
<!-- ############################################################
    í˜ì´ì§€ ë§í¬
############################################################ -->
{% for page in page_range %}
    {# page == í˜„ì¬í˜ì´ì§€ë²ˆí˜¸(page_obj.number)#}
    {% if page == page_obj.number %}
        <li class='page-item active'>
            <span class='page-link'>{{page}}</span>
        </li>
    {% else%}
        <li class='page-item '>
            <a href="{% url 'login_user' user.username%}?page={{page}}" class='page-link '>{{page}}</a>
        </li>
    {% endif %}
{% endfor %}


<!-- ############################################################
    ë‹¤ìŒ í˜ì´ì§€ ê·¸ë£¹ ì´ë™ ë§í¬
############################################################ -->
{% if has_next %}
    <li class='page-item'>
        <a href="{%url 'login_user' user.username%}?page={{next_page_no}}" class='page-link'>ë‹¤ìŒ</a>
    </li>
{% else %}
    <li class='page-item'>
        <span class='page-link'>&raquo;</span>
    </li>
{% endif %}
</ul>
{% endif %}
{% endif %}
</div> {#div card_list#}
<a href = "{%url 'account:logout'%}">ë‚˜ë§Œì˜ ìš°í¸í•¨ ë§Œë“¤ê¸°</a>
{% endblock contents%}